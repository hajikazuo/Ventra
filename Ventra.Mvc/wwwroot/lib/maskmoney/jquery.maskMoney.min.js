(function(n){"use strict";n.browser||(n.browser={},n.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase()),n.browser.webkit=/webkit/.test(navigator.userAgent.toLowerCase()),n.browser.opera=/opera/.test(navigator.userAgent.toLowerCase()),n.browser.msie=/msie/.test(navigator.userAgent.toLowerCase()));var t={destroy:function(){return n(this).unbind(".maskMoney"),n.browser.msie&&(this.onpaste=null),this},mask:function(t){return this.each(function(){var i=n(this),r;return typeof t=="number"&&(i.trigger("mask"),r=n(i.val().split(/\D/)).last()[0].length,t=t.toFixed(r),i.val(t)),i.trigger("mask")})},unmasked:function(){return this.map(function(){var t=n(this).val()||"0",r=t.indexOf("-")!==-1,i;return n(t.split(/\D/).reverse()).each(function(n,t){if(t)return i=t,!1}),t=t.replace(/\D/g,""),t=t.replace(new RegExp(i+"$"),"."+i),r&&(t="-"+t),parseFloat(t)})},init:function(t){return t=n.extend({prefix:"",suffix:"",affixesStay:!0,thousands:",",decimal:".",precision:2,allowZero:!1,allowNegative:!1},t),this.each(function(){function r(){var n=i.get(0),r=0,t=0,s,e,u,f,o;return typeof n.selectionStart=="number"&&typeof n.selectionEnd=="number"?(r=n.selectionStart,t=n.selectionEnd):(e=document.selection.createRange(),e&&e.parentElement()===n&&(f=n.value.length,s=n.value.replace(/\r\n/g,"\n"),u=n.createTextRange(),u.moveToBookmark(e.getBookmark()),o=n.createTextRange(),o.collapse(!1),u.compareEndPoints("StartToEnd",o)>-1?r=t=f:(r=-u.moveStart("character",-f),r+=s.slice(0,r).split("\n").length-1,u.compareEndPoints("EndToEnd",o)>-1?t=f:(t=-u.moveEnd("character",-f),t+=s.slice(0,t).split("\n").length-1)))),{start:r,end:t}}function v(){var t=!(i.val().length>=i.attr("maxlength")&&i.attr("maxlength")>=0),n=r(),u=n.start,f=n.end,e=n.start!==n.end&&i.val().substring(u,f).match(/\d/)?!0:!1,o=i.val().substring(0,1)==="0";return t||e||o}function y(n){i.each(function(t,i){if(i.setSelectionRange)i.focus(),i.setSelectionRange(n,n);else if(i.createTextRange){var r=i.createTextRange();r.collapse(!0);r.moveEnd("character",n);r.moveStart("character",n);r.select()}})}function u(n){var i="";return n.indexOf("-")>-1&&(n=n.replace("-",""),i="-"),i+t.prefix+n+t.suffix}function h(n){var s=n.indexOf("-")>-1&&t.allowNegative?"-":"",r=n.replace(/[^0-9]/g,""),i=r.slice(0,r.length-t.precision),f,e,o;return i=i.replace(/^0*/g,""),i=i.replace(/\B(?=(\d{3})+(?!\d))/g,t.thousands),i===""&&(i="0"),f=s+i,t.precision>0&&(e=r.slice(r.length-t.precision),o=new Array(t.precision+1-e.length).join(0),f+=t.decimal+o+e),u(f)}function c(n){var r=i.val().length,t;i.val(h(i.val()));t=i.val().length;n=n-(r-t);y(n)}function f(){var n=i.val();i.val(h(n))}function p(){var n=i.val();return t.allowNegative?n!==""&&n.charAt(0)==="-"?n.replace("-",""):"-"+n:n}function e(n){n.preventDefault?n.preventDefault():n.returnValue=!1}function l(t){t=t||window.event;var u=t.which||t.charCode||t.keyCode,h,o,s,l,f;return u===undefined?!1:u<48||u>57?u===45?(i.val(p()),!1):u===43?(i.val(i.val().replace("-","")),!1):u===13||u===9?!0:n.browser.mozilla&&(u===37||u===39)&&t.charCode===0?!0:(e(t),!0):v()?(e(t),h=String.fromCharCode(u),o=r(),s=o.start,l=o.end,f=i.val(),i.val(f.substring(0,s)+h+f.substring(l,f.length)),c(s+1),!1):!1}function w(n){n=n||window.event;var f=n.which||n.charCode||n.keyCode,h,u,s,o,l;return f===undefined?!1:(h=r(),u=h.start,s=h.end,f===8||f===46||f===63272?(e(n),o=i.val(),u===s&&(f===8?t.suffix===""?u-=1:(l=o.split("").reverse().join("").search(/\d/),u=o.length-l-1,s=u+1):s+=1),i.val(o.substring(0,u)+o.substring(s,o.length)),c(u),!1):f===9?!0:!0)}function b(){s=i.val();f();var t=i.get(0),n;t.createTextRange&&(n=t.createTextRange(),n.collapse(!1),n.select())}function a(){setTimeout(function(){f()},0)}function o(){var n=parseFloat("0")/Math.pow(10,t.precision);return n.toFixed(t.precision).replace(new RegExp("\\.","g"),t.decimal)}function k(r){if(n.browser.msie&&l(r),i.val()===""||i.val()===u(o()))t.allowZero?t.affixesStay?i.val(u(o())):i.val(o()):i.val("");else if(!t.affixesStay){var f=i.val().replace(t.prefix,"").replace(t.suffix,"");i.val(f)}i.val()!==s&&i.change()}function d(){var t=i.get(0),n;t.setSelectionRange?(n=i.val().length,t.setSelectionRange(n,n)):i.val(i.val())}var i=n(this),s;t=n.extend(t,i.data());i.unbind(".maskMoney");i.bind("keypress.maskMoney",l);i.bind("keydown.maskMoney",w);i.bind("blur.maskMoney",k);i.bind("focus.maskMoney",b);i.bind("click.maskMoney",d);i.bind("cut.maskMoney",a);i.bind("paste.maskMoney",a);i.bind("mask.maskMoney",f)})}};n.fn.maskMoney=function(i){if(t[i])return t[i].apply(this,Array.prototype.slice.call(arguments,1));if(typeof i!="object"&&i)n.error("Method "+i+" does not exist on jQuery.maskMoney");else return t.init.apply(this,arguments)}})(window.jQuery||window.Zepto);